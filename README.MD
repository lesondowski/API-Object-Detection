# YOLO Object Detection API (No Copyright Statement) âœ…

**Short Description:**
This project provides an object detection API powered by a YOLO-based model, using FastAPI as the backend. The application supports both image URLs and direct image uploads from local machines, performs object detection, and returns results along with annotated images (bounding boxes).

---

## ğŸ”§ TÃ­nh nÄƒng chÃ­nh
- Accept images via URL or direct file upload
- JSON-based inference API for programmatic usage (`/predict/`)
- Simple web interface (Jinja2) to submit URLs or upload images and view annotated results (`/` â†’ form)
- Bounding boxes rendered with OpenCV; no file persistence (in-memory processing with data URI responses)

---

## ğŸ“ Cáº¥u trÃºc thÆ° má»¥c (tÃ³m táº¯t)
- `api/` â€” FastAPI app
  - `main.py` â€” entrypoint vÃ  cáº¥u hÃ¬nh templates/static
  - `routers/predict_router.py` â€” API vÃ  web routes
- `models/predict.py` â€” load áº£nh, gá»i model, helper xá»­ lÃ½ áº£nh
- `api/files/model/` â€” chá»©a cÃ¡c mÃ´ hÃ¬nh (.pt, .onnx, tflite)
- `templates/` â€” Jinja2 HTML templates (home / results)
- `static/` â€” tÃ i nguyÃªn tÄ©nh (CSS/JS náº¿u cáº§n)
- `requirements.txt` â€” thÆ° viá»‡n cáº§n cÃ i Ä‘áº·t

---

## âš™ï¸ YÃªu cáº§u & cÃ i Ä‘áº·t
- Python 3.10+
- CÃ i Ä‘áº·t dependencies:

```bash
pip install -r requirements.txt
```

LÆ°u Ã½: láº§n cháº¡y Ä‘áº§u tiÃªn cÃ³ thá»ƒ cháº­m do táº£i mÃ´ hÃ¬nh; cáº§n cÃ³ káº¿t ná»‘i internet náº¿u mÃ´ hÃ¬nh cáº§n táº£i.

---

## ğŸ›  Cáº¥u hÃ¬nh mÃ´ hÃ¬nh (quick)
Má»Ÿ `utils_cf/config.py` Ä‘á»ƒ chá»‰nh:
```python
DEVICE = "cuda" if torch.cuda.is_available() else "cpu"
MODEL_OD_PT = "api/files/model/pt/ADYL11m.pt"
MODEL_IS_ONNX = "api/files/model/onnx/AD_YL11s_Seg_1.80.onnx"
MODEL_BLOCK_PT = "api/files/model/pt/AD_Productblock_YL11.pt"
```
- Thay Ä‘Æ°á»ng dáº«n tá»›i mÃ´ hÃ¬nh mong muá»‘n náº¿u cáº§n.
- Äá»ƒ Ã©p cháº¡y trÃªn CPU, Ä‘áº·t `DEVICE = "cpu"`.

---

## â–¶ï¸ Cháº¡y server (local)
```bash
uvicorn api.main:app --reload --host 0.0.0.0 --port 10000
```
Má»Ÿ trÃ¬nh duyá»‡t tá»›i `http://localhost:10000/` Ä‘á»ƒ truy cáº­p giao diá»‡n web, hoáº·c dÃ¹ng Postman Ä‘á»ƒ gá»i API.

---

## ğŸ“¬ API & Web endpoints
1) POST `/predict/` (JSON) â€” programmatic
- Body JSON:
```json
{
  "image_urls": ["https://example.com/img1.jpg"],
  "conf_input": 0.24,
  "iou_input": 0.2,
  "portion": "Lon & Chai",
  "repuirements_count": 1
}
```
- Tráº£ vá»: JSON chá»©a thá»‘ng kÃª phÃ¡t hiá»‡n (sá»‘ lÆ°á»£ng theo lá»›p, thÃ´ng tin block náº¿u Ã¡p dá»¥ng).

2) POST `/predict/detect_form` (form-data) â€” web form / Postman file upload
- Fields (form-data):
  - `image_urls` (text, má»—i URL 1 dÃ²ng)
  - `files` (file, há»— trá»£ nhiá»u files)
  - `conf_input`, `iou_input`, `portion`, `repuirements_count`
- Tráº£ vá»: HTML trang káº¿t quáº£ cÃ³ áº£nh Ä‘Ã£ annotate (embedded data URI) vÃ  JSON counts.

3) GET `/` â€” form web Ä‘á»ƒ input URL / upload áº£nh.

---

## ğŸ§ª Test nhanh báº±ng Postman / curl
- JSON request (URL flow):
```bash
curl -X POST "http://localhost:10000/predict/" -H "Content-Type: application/json" -d '{"image_urls":["https://example.com/img.jpg"]}'
```
- File upload (form):
```bash
curl -X POST "http://localhost:10000/predict/detect_form" -F "files=@/path/to/image.jpg" -F "conf_input=0.24"
```
